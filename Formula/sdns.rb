# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Sdns < Formula
  desc "A high-performance, recursive DNS resolver server with DNSSEC support, focused on preserving privacy"
  homepage "https://sdns.dev"
  version "1.3.7"

  depends_on "go" => :build

  on_macos do
    on_intel do
      url "https://github.com/semihalev/sdns/releases/download/v1.3.7/sdns-1.3.7_darwin_amd64.tar.gz"
      sha256 "b20b5d4c964ab00f2ee2e12ea73c693283c3531619da4f2c54d539af7b3a3720"

      def install
        bin.install "sdns"
      end
    end
    on_arm do
      url "https://github.com/semihalev/sdns/releases/download/v1.3.7/sdns-1.3.7_darwin_arm64.tar.gz"
      sha256 "ee62792d030539f4caab5010c2f88459e0e2676b4e8d4e6c2901a67226177a15"

      def install
        bin.install "sdns"
      end
    end
  end

  on_linux do
    on_intel do
      if Hardware::CPU.is_64_bit?
        url "https://github.com/semihalev/sdns/releases/download/v1.3.7/sdns-1.3.7_linux_amd64.tar.gz"
        sha256 "ef4119cd87ae62567290700a8deb5d3d5c3fbb632dee776b6af4703d8d8c56f9"

        def install
          bin.install "sdns"
        end
      end
    end
    on_arm do
      if !Hardware::CPU.is_64_bit?
        url "https://github.com/semihalev/sdns/releases/download/v1.3.7/sdns-1.3.7_linux_armv6.tar.gz"
        sha256 "a7bf2fee1f4727ccd488e3775cc74f62266f2efb1e2aee247041b8badf605a01"

        def install
          bin.install "sdns"
        end
      end
    end
    on_arm do
      if Hardware::CPU.is_64_bit?
        url "https://github.com/semihalev/sdns/releases/download/v1.3.7/sdns-1.3.7_linux_arm64.tar.gz"
        sha256 "e819bda06af661bd33458687728d49150d0c6d0ff037586a10bb0e1384e3169c"

        def install
          bin.install "sdns"
        end
      end
    end
  end

  service do
    run [opt_bin/"sdns", "-config", etc/"sdns.conf"]
    keep_alive true
    require_root true
    error_log_path var/"log/sdns.log"
    log_path var/"log/sdns.log"
    working_dir opt_prefix
  end

  test do
    fork do
      exec bin/"sdns", "-config", testpath/"sdns.conf"
    end
    sleep(2)
    assert_predicate testpath/"sdns.conf", :exist?
  end
end
